---
title: "NRES803"
author: "Nieto_Lopez"
date: "5/7/2019"

output: 
 html_document: 
    df_print: paged
    toc: TRUE
    toc_depth: 2
  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
```
## Background
On soybean and dry bean, _S. sclerotiorum_ is recognized as an important yield-limiting disease in many countries, including Argentina, the USA and Brazil. One method of disease control is well-timed fungicide applications. Intensive use of these fungicides, especially of site-specific products, can select for resistant or tolerant isolates and may consequently lead to control failures. Fungicide resistance during an epidemic may result in financial loss to growers applying fungicides and yield loss to disease. Estimation of fungicide sensitivity is typically performed by determination of the EC50, which is the concentration of a fungicide that inhibits growth by 50 %.  This value is the most commonly used parameter for assessing fungicide sensitivity for filamentous plant pathogens (fungi and oomycetes) in order of detecting shifts in fungicide sensitivity within pathogen populations.

To determine EC50, inhibition of mycelial growth is the most common approach, wherein the agar dilution (AD) or also  plate dilution (PD) method is most common and involves amending media with fungicides in a serial dilution of concentrations.  Growth of the fungus at each concentration is measured by a dose-response curve fitted to the data to estimate EC50. A relatively newer method involves the use of a spiral plater for determining fungicide sensitivity. Since the development of spiral gradient (SG), it has been applied for one oomycete species and several species among ascomycetes, basidiomycetes, and zygomycetes. Some variation was observed between AD and SG that was speculated to be due to differences in inoculation methodologies. The agar plug containing mycelium is used for AD, whereas pre-inoculated cellophane paper strips are used for SG. Since there is no nutrient content present in cellophane, it was suggested that nutrients and living mycelium within the agar plug served as a reservoir of unaffected mycelial growth, which may directly affect correlations between the fungicide sensitivity methods. Although this mechanism seems possible, the authors did not test this hypothesis. Comparison of EC50 estimates from other methods to estimates from AD may be insufficient if AD is inherently inaccurate or biased.

Variability in fungus-fungicide interactions may affect the accuracy and applicability of SG. Several methods exist for determining fungicide sensitivity, however no studies have compared them to determine if they yield similar, or accurate results for _S. sclerotiorum_.  

## Research  

 Thirty-four _S. sclerotiorum_ isolates were used for seven fungicides with different modes of action: iprodione, procymidone (dicarboximides), thiophanate methyl (MBC), fluazinam (phenyl-pyridinamine), boscalid (SDHI), prothioconazole (DMI), and pyraclostrobin (QoI). For AD, average colony diameter was used to fit a dose-response curve for each isolate using log-logistic regression with the ezec package using the “LL.3” model implemented in the drc package in R software version. The EC50 of AD and SG varied by fungicide and settings used for SG. The EC50 values obtained from AD and SG (2-day settings) were not significantly different for boscalid, pyraclostrobin and when data for all fungicides were combined (P > 0.05). Linear regression of EC50 between AD and SG (1-day settings) just for prothioconazole had results approaching expectations (slope = 0.86, r2 = 0.61. Overall, the EC50 of AD and SG, growth inhibition obtained from plug and paper inoculation, and validation of accuracy of AD varied among fungicides.

Since EC50 of 23 soybean isolates had been determined previously by AD, we decided to use their average as the discriminatory dose,then, 11 isolates were used to compare growth from agar plugs to cellulose discs (different inoculum) in AD.

In SG, a fungal isolate grows on a continuous fungicide concentration gradient. For different fungicides, fungal growth may respond gradually or abruptly to changes in fungicide concentrations. Fungus-fungicide interactions leading to abrupt growth response in the 50% inhibition zone may affect the accuracy and, thus, applicability of this method. This can be studied by screening a large set of isolates (>30) from one species against fungicides with different modes of action. Previous studies either did not use substantial number of isolates from the same species or did not test several fungicides with different modes of action. Results of these two methods for this sterile fungus (incapable of producing spores in culture) were inconsistent, possibly because spores released from the mycelium can advance growth farther on a spiral gradient as they contain nutrients provided by the mycelium. Thus, estimates of EC50 of spore-producing fungi on the spiral gradient are really combinations of effects on the mycelium and on the spore. Almost all other studies that reported good correlations between the methods used fungi that are spore producers (i.e. _Alternaria_, _Fusarium_, _Monilinia_, _Botrytis_, and  _Penicillium_ spp.). However, one caveat to this argument is that it is difficult to know whether those fungi were actively producing spores when plated onto fungicide-amended plates (either AD or SG). To test this, eight isolates of _Botrytis cinerea_, a fungus with the ability to produce spores andvery close related with _Sclerotinia sclerotiorum_, were subjected to the same methodology for the two fungicides.

## Objectives of the research

The first objective of the present study was to compare the EC50 calculated from mycelial growth using AD and SG. The second objective was to compare agar plug and paper inoculations for mycelial growth on fungicide amended media. The third objective was to validate EC50 obtained by AD.

 What is the ecological hypothesis or model of interest?  
      The model of interest is a linear model, maybe considering more covariances and what about if the model that fits better is another one different. There are approximately 8 citations that mention linear model is good Spiral gradient for other fungi different than _Sclerotinia_.  

  What variables were measured?  
  EC50 of AD, EC50 of SG by setting one (own feature of the special software), EC50 of SG by setting two (own feature of the special software) using discriminatory doses of 7 fungicides and 34 different isolates of _Sclerotinia sclerotiorum_.

 What do you THINK the best analysis is?  

Assumptions of ANOVA,  Assumptions of linear model,  and test different models base on EC50 values from AD and SG. The same but based on inhibition growth


## Setting the packages and wrangling

```{r set packages, echo=TRUE, warning= FALSE, include=FALSE}

packages <- c("tidyverse","agricolae", "mosaic", "broom", "car","lawstat", "ggridges", "cowplot", "gridExtra", "arsenal", "DescTools","ezec", "lmodel2")
lapply( packages, require, character.only = TRUE)

  
```

```{r reading data, echo=FALSE, include=FALSE}
#####boscalid  Plate dilution

boscalid.data <-
read.csv("data/boscalid.csv")
  
boscalid.data$repeats <- rep_len(1:4, length.out = nrow(boscalid.data))
boscalid.data$ID <- as.character(boscalid.data$ID)
  # renaming ID for the current names
boscalid.data$ID[ boscalid.data$ID =="541B"]  <- "541" 

boscalid.data$ID[ boscalid.data$ID =="293E"]  <- "293" 
boscalid.data$ID[ boscalid.data$ID =="973B"]  <- "973" 
boscalid.data$ID[ boscalid.data$ID =="973C"]  <- "973" 
boscalid.data$ID[ boscalid.data$ID =="973D"]  <- "973" 
boscalid.data$ID[ boscalid.data$ID =="974A"]  <- "974" 
boscalid.data$ID[ boscalid.data$ID =="974B"]  <- "974" 
boscalid.data$ID[ boscalid.data$ID =="974C"]  <- "974" 
boscalid.data$ID[ boscalid.data$ID =="974D"]  <- "974" 
boscalid.data$ID[ boscalid.data$ID =="975C"]  <- "975" 
boscalid.data$ID[ boscalid.data$ID =="975D"]  <- "975" 
boscalid.data$ID[ boscalid.data$ID =="975E"]  <- "975" 
boscalid.data$ID[ boscalid.data$ID =="976B"]  <- "976"
boscalid.data$ID[ boscalid.data$ID =="976C"]  <- "976"
boscalid.data$ID[ boscalid.data$ID =="977B"]  <- "977"
boscalid.data$ID[ boscalid.data$ID =="978B"]  <- "978"

  ####Transforming to $ID to numeric
boscalid.data$ID <- as.numeric(boscalid.data$ID)
  # Filter out 
boscalid.data <- boscalid.data %>%
     #filter(!dose ==  0.4 & !ID == 800) %>%
mutate(response= replace(response, response == 0, 0.6))  #replacing 0 cm growth for the size of plug that is 0.6
    
#####boscalid  Spiral gradient
boscalid.SG <-
read.csv("data/1_Day_SG/Boscalid.csv")
  
boscalid.SG <- boscalid.SG %>% 
rename(ID= Isolate)
  
boscalid.SG$ID <- as.character(boscalid.SG$ID)
# renaming ID for the current names
boscalid.SG$ID[ boscalid.SG$ID =="541B"]  <- "541" 

boscalid.SG$ID[ boscalid.SG$ID =="293E"]  <- "293" 
boscalid.SG$ID[ boscalid.SG$ID =="973B"]  <- "973" 
boscalid.SG$ID[ boscalid.SG$ID =="973C"]  <- "973" 
boscalid.SG$ID[ boscalid.SG$ID =="973D"]  <- "973" 
boscalid.SG$ID[ boscalid.SG$ID =="974A"]  <- "974" 
boscalid.SG$ID[ boscalid.SG$ID =="974B"]  <- "974" 
boscalid.SG$ID[ boscalid.SG$ID =="974C"]  <- "974" 
boscalid.SG$ID[ boscalid.SG$ID =="974D"]  <- "974" 
boscalid.SG$ID[ boscalid.SG$ID =="975C"]  <- "975" 
boscalid.SG$ID[ boscalid.SG$ID =="975D"]  <- "975" 
boscalid.SG$ID[ boscalid.SG$ID =="975E"]  <- "975" 
boscalid.SG$ID[ boscalid.SG$ID =="976B"]  <- "976"
boscalid.SG$ID[ boscalid.SG$ID =="976C"]  <- "976"
boscalid.SG$ID[ boscalid.SG$ID =="977B"]  <- "977"
boscalid.SG$ID[ boscalid.SG$ID =="978B"]  <- "978"

####Transforming to $ID to numeric
boscalid.SG$ID <- as.numeric(boscalid.SG$ID)
# Filter out 
boscalid.SG <- boscalid.SG %>%
group_by(ID) %>%  
mutate(Average=mean(EC50)) %>% 
select(- EC50) %>% 
rename(EC50_SG= Average) %>% 
unique() %>% 
ungroup()
  
###Fluazinam Plate dilution
  
fluazinam.data <-
  read.csv("data/fluazinam.csv")
  
fluazinam.data$repeats <- rep_len(1:4, length.out = nrow(fluazinam.data))
fluazinam.data$ID <- as.character(fluazinam.data$ID)
  # renaming ID for the current names
fluazinam.data$ID[ fluazinam.data$ID =="541B"]  <- "541" 

fluazinam.data$ID[ fluazinam.data$ID =="293E"]  <- "293" 
fluazinam.data$ID[ fluazinam.data$ID =="973B"]  <- "973" 
fluazinam.data$ID[ fluazinam.data$ID =="973C"]  <- "973" 
fluazinam.data$ID[ fluazinam.data$ID =="973D"]  <- "973"
fluazinam.data$ID[ fluazinam.data$ID =="974A"]  <- "974" 
fluazinam.data$ID[ fluazinam.data$ID =="974B"]  <- "974" 
fluazinam.data$ID[ fluazinam.data$ID =="974C"]  <- "974" 
fluazinam.data$ID[ fluazinam.data$ID =="974D"]  <- "974" 
fluazinam.data$ID[ fluazinam.data$ID =="975C"]  <- "975" 
fluazinam.data$ID[ fluazinam.data$ID =="975D"]  <- "975" 
fluazinam.data$ID[ fluazinam.data$ID =="975E"]  <- "975" 
fluazinam.data$ID[ fluazinam.data$ID =="976B"]  <- "976"
fluazinam.data$ID[ fluazinam.data$ID =="976C"]  <- "976"
fluazinam.data$ID[ fluazinam.data$ID =="977B"]  <- "977"
fluazinam.data$ID[ fluazinam.data$ID =="978B"]  <- "978"

 
####Transforming to $ID to numeric
fluazinam.data$ID <- as.numeric(fluazinam.data$ID)
# Filter out 
fluazinam.data <- fluazinam.data %>%
mutate(response= replace(response, response == 0, 0.6))  #replacing 0 cm growth for the size of plug that is 0.6
 

  ###Fluazinam Spiral Gradient
fluazinam.SG <-
read.csv("data/1_Day_SG/Fluazinam.csv")
  
fluazinam.SG <- fluazinam.SG %>% 
rename(ID= Isolate)
  
fluazinam.SG$ID <- as.character(fluazinam.SG$ID)
# renaming ID for the current names
fluazinam.SG$ID[ fluazinam.SG$ID =="541B"]  <- "541" 

fluazinam.SG$ID[ fluazinam.SG$ID =="293E"]  <- "293" 
fluazinam.SG$ID[ fluazinam.SG$ID =="973B"]  <- "973" 
fluazinam.SG$ID[ fluazinam.SG$ID =="973C"]  <- "973" 
fluazinam.SG$ID[ fluazinam.SG$ID =="973D"]  <- "973" 
fluazinam.SG$ID[ fluazinam.SG$ID =="974A"]  <- "974" 
fluazinam.SG$ID[ fluazinam.SG$ID =="974B"]  <- "974" 
fluazinam.SG$ID[ fluazinam.SG$ID =="974C"]  <- "974" 
fluazinam.SG$ID[ fluazinam.SG$ID =="974D"]  <- "974" 
fluazinam.SG$ID[ fluazinam.SG$ID =="975C"]  <- "975" 
fluazinam.SG$ID[ fluazinam.SG$ID =="975D"]  <- "975" 
fluazinam.SG$ID[ fluazinam.SG$ID =="975E"]  <- "975" 
fluazinam.SG$ID[ fluazinam.SG$ID =="976B"]  <- "976"
fluazinam.SG$ID[ fluazinam.SG$ID =="976C"]  <- "976"
fluazinam.SG$ID[ fluazinam.SG$ID =="977B"]  <- "977"
fluazinam.SG$ID[ fluazinam.SG$ID =="978B"]  <- "978"

 
####Transforming to $ID to numeric
fluazinam.SG$ID <- as.numeric(fluazinam.SG$ID)
# Filter out 
fluazinam.SG <- fluazinam.SG %>%
group_by(ID) %>%  
mutate(Average=mean(EC50)) %>% 
select(- EC50) %>% 
rename(EC50_SG= Average) %>% 
unique() %>% 
ungroup()


  
#######Iprodione Plate dilution

iprodione.data <-
read.csv("data/iprodione.csv")
  
iprodione.data$repeats <- rep_len(1:4, length.out = nrow(iprodione.data))
iprodione.data$ID <- as.character(iprodione.data$ID)
# renaming ID for the current names
iprodione.data$ID[ iprodione.data$ID =="541B"]  <- "541" 

iprodione.data$ID[ iprodione.data$ID =="293E"]  <- "293" 
iprodione.data$ID[ iprodione.data$ID =="973B"]  <- "973" 
iprodione.data$ID[ iprodione.data$ID =="973C"]  <- "973" 
iprodione.data$ID[ iprodione.data$ID =="973D"]  <- "973"
iprodione.data$ID[ iprodione.data$ID =="974A"]  <- "974" 
iprodione.data$ID[ iprodione.data$ID =="974B"]  <- "974" 
iprodione.data$ID[ iprodione.data$ID =="974C"]  <- "974" 
iprodione.data$ID[ iprodione.data$ID =="974D"]  <- "974" 
iprodione.data$ID[ iprodione.data$ID =="975C"]  <- "975" 
iprodione.data$ID[ iprodione.data$ID =="975D"]  <- "975" 
iprodione.data$ID[ iprodione.data$ID =="975E"]  <- "975" 
iprodione.data$ID[ iprodione.data$ID =="976B"]  <- "976"
iprodione.data$ID[ iprodione.data$ID =="976C"]  <- "976"
iprodione.data$ID[ iprodione.data$ID =="977B"]  <- "977"
iprodione.data$ID[ iprodione.data$ID =="978B"]  <- "978"

 
####Transforming to $ID to numeric
iprodione.data$ID <- as.numeric(iprodione.data$ID)
# Filter out 
iprodione.data <- iprodione.data %>%
mutate(response= replace(response, response == 0, 0.6))  #replacing 0 cm growth for the size of plug that is 0.6
    
 ###Iprodione Spiral Gradient
iprodione.SG <-
read.csv("data/1_Day_SG/Iprodione.csv")
  
iprodione.SG <- iprodione.SG %>% 
rename(ID= Isolate)
  
iprodione.SG$ID <- as.character(iprodione.SG$ID)
# renaming ID for the current names
iprodione.SG$ID[ iprodione.SG$ID =="541B"]  <- "541" 

iprodione.SG$ID[ iprodione.SG$ID =="293E"]  <- "293" 
iprodione.SG$ID[ iprodione.SG$ID =="973B"]  <- "973" 
iprodione.SG$ID[ iprodione.SG$ID =="973C"]  <- "973" 
iprodione.SG$ID[ iprodione.SG$ID =="973D"]  <- "973" 
iprodione.SG$ID[ iprodione.SG$ID =="974A"]  <- "974" 
iprodione.SG$ID[ iprodione.SG$ID =="974B"]  <- "974" 
iprodione.SG$ID[ iprodione.SG$ID =="974C"]  <- "974" 
iprodione.SG$ID[ iprodione.SG$ID =="974D"]  <- "974" 
iprodione.SG$ID[ iprodione.SG$ID =="975C"]  <- "975" 
iprodione.SG$ID[ iprodione.SG$ID =="975D"]  <- "975" 
iprodione.SG$ID[ iprodione.SG$ID =="975E"]  <- "975" 
iprodione.SG$ID[ iprodione.SG$ID =="976B"]  <- "976"
iprodione.SG$ID[ iprodione.SG$ID =="976C"]  <- "976"
iprodione.SG$ID[ iprodione.SG$ID =="977B"]  <- "977"
iprodione.SG$ID[ iprodione.SG$ID =="978B"]  <- "978"

 
 ####Transforming to $ID to numeric
 iprodione.SG$ID <- as.numeric(iprodione.SG$ID)
 # Filter out 
 iprodione.SG <- iprodione.SG %>%
 group_by(ID) %>%  
 mutate(Average=mean(EC50)) %>% 
 select(- EC50) %>% 
 rename(EC50_SG= Average) %>% 
 unique() %>% 
ungroup()
  
    
  
###Procymidone Plate dilution
  
procymidone.data <-
read.csv("data/procymidone.csv")
  
procymidone.data$repeats <- rep_len(1:4, length.out = nrow(procymidone.data))
procymidone.data$ID <- as.character(procymidone.data$ID)
  # renaming ID for the current names
procymidone.data$ID[ procymidone.data$ID =="541B"]  <- "541" 

procymidone.data$ID[ procymidone.data$ID =="293E"]  <- "293" 
procymidone.data$ID[ procymidone.data$ID =="973B"]  <- "973" 
procymidone.data$ID[ procymidone.data$ID =="973C"]  <- "973" 
procymidone.data$ID[ procymidone.data$ID =="973D"]  <- "973" 
procymidone.data$ID[ procymidone.data$ID =="974A"]  <- "974" 
procymidone.data$ID[ procymidone.data$ID =="974B"]  <- "974" 
procymidone.data$ID[ procymidone.data$ID =="974C"]  <- "974" 
procymidone.data$ID[ procymidone.data$ID =="974D"]  <- "974" 
procymidone.data$ID[ procymidone.data$ID =="975C"]  <- "975" 
procymidone.data$ID[ procymidone.data$ID =="975D"]  <- "975" 
procymidone.data$ID[ procymidone.data$ID =="975E"]  <- "975" 
procymidone.data$ID[ procymidone.data$ID =="976B"]  <- "976"
procymidone.data$ID[ procymidone.data$ID =="976C"]  <- "976"
procymidone.data$ID[ procymidone.data$ID =="977B"]  <- "977"
procymidone.data$ID[ procymidone.data$ID =="978B"]  <- "978"


 ####Transforming to $ID to numeric
 procymidone.data$ID <- as.numeric(procymidone.data$ID)
 # Filter out 
 procymidone.data <- procymidone.data %>%
 #filter(!dose ==  0.4 & !ID == 800) %>%
 mutate(response= replace(response, response == 0, 0.6))  #replacing 0 cm growth for the size of plug that is 0.6
  
  ###Procymidone Spiral Gradient
 procymidone.SG <-
 read.csv("data/1_Day_SG/Procymidone.csv")
  
 procymidone.SG <- procymidone.SG %>% 
 rename(ID= Isolate)
  
 procymidone.SG$ID <- as.character(procymidone.SG$ID)
 # renaming ID for the current names
 procymidone.SG$ID[ procymidone.SG$ID =="541B"]  <- "541" 

 procymidone.SG$ID[ procymidone.SG$ID =="293E"]  <- "293" 
 procymidone.SG$ID[ procymidone.SG$ID =="973B"]  <- "973" 
 procymidone.SG$ID[ procymidone.SG$ID =="973C"]  <- "973" 
 procymidone.SG$ID[ procymidone.SG$ID =="973D"]  <- "973" 
 procymidone.SG$ID[ procymidone.SG$ID =="974A"]  <- "974" 
 procymidone.SG$ID[ procymidone.SG$ID =="974B"]  <- "974" 
 procymidone.SG$ID[ procymidone.SG$ID =="974C"]  <- "974" 
 procymidone.SG$ID[ procymidone.SG$ID =="974D"]  <- "974" 
 procymidone.SG$ID[ procymidone.SG$ID =="975C"]  <- "975" 
 procymidone.SG$ID[ procymidone.SG$ID =="975D"]  <- "975" 
 procymidone.SG$ID[ procymidone.SG$ID =="975E"]  <- "975" 
 procymidone.SG$ID[ procymidone.SG$ID =="976B"]  <- "976"
 procymidone.SG$ID[ procymidone.SG$ID =="976C"]  <- "976"
 procymidone.SG$ID[ procymidone.SG$ID =="977B"]  <- "977"
 procymidone.SG$ID[ procymidone.SG$ID =="978B"]  <- "978"

 
 ####Transforming to $ID to numeric
 procymidone.SG$ID <- as.numeric(procymidone.SG$ID)
  # Filter out 
 procymidone.SG <- procymidone.SG %>%
 group_by(ID) %>%  
 mutate(Average=mean(EC50)) %>% 
 select(- EC50) %>% 
 rename(EC50_SG= Average) %>% 
 unique() %>% 
 ungroup()
    
  
  ###Prothioconazole Plate dilution
  prothioconazole.data <-
  read.csv("data/prothioconazole.csv")
  
prothioconazole.data$repeats <- rep_len(1:4, length.out = nrow(prothioconazole.data))
prothioconazole.data$ID <- as.character(prothioconazole.data$ID)
# renaming ID for the current names
prothioconazole.data$ID[ prothioconazole.data$ID =="541B"]  <- "541" 

prothioconazole.data$ID[ prothioconazole.data$ID =="293E"]  <- "293" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="973B"]  <- "973" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="973C"]  <- "973"
 prothioconazole.data$ID[ prothioconazole.data$ID =="973D"]  <- "973"
 prothioconazole.data$ID[ prothioconazole.data$ID =="974A"]  <- "974" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="974B"]  <- "974" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="974C"]  <- "974" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="974D"]  <- "974" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="975C"]  <- "975" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="975D"]  <- "975" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="975E"]  <- "975" 
 prothioconazole.data$ID[ prothioconazole.data$ID =="976B"]  <- "976"
 prothioconazole.data$ID[ prothioconazole.data$ID =="976C"]  <- "976"
 prothioconazole.data$ID[ prothioconazole.data$ID =="977B"]  <- "977"
 prothioconazole.data$ID[ prothioconazole.data$ID =="978B"]  <- "978"

 
####Transforming to $ID to numeric
prothioconazole.data$ID <- as.numeric(prothioconazole.data$ID)
# Filter out 
prothioconazole.data <- prothioconazole.data %>%

    mutate(response= replace(response, response == 0, 0.6))  #replacing 0 cm growth for the size of plug that is 0.6
    
###Prothioconazole Spiral Gradient
prothioconazole.SG <-
read.csv("data/1_Day_SG/Prothioconazole.csv")
  
prothioconazole.SG <- prothioconazole.SG %>% 
rename(ID= Isolate)
  
prothioconazole.SG$ID <- as.character(prothioconazole.SG$ID)
# renaming ID for the current names
prothioconazole.SG$ID[ prothioconazole.SG$ID =="541B"]  <- "541" 

prothioconazole.SG$ID[ prothioconazole.SG$ID =="293E"]  <- "293" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="973B"]  <- "973" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="973C"]  <- "973" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="973D"]  <- "973" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="974A"]  <- "974" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="974B"]  <- "974" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="974C"]  <- "974" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="974D"]  <- "974" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="975C"]  <- "975" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="975D"]  <- "975" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="975E"]  <- "975" 
prothioconazole.SG$ID[ prothioconazole.SG$ID =="976B"]  <- "976"
prothioconazole.SG$ID[ prothioconazole.SG$ID =="976C"]  <- "976"
prothioconazole.SG$ID[ prothioconazole.SG$ID =="977B"]  <- "977"
prothioconazole.SG$ID[prothioconazole.SG$ID == "978B"]  <- "978"

 
####Transforming to $ID to numeric
prothioconazole.SG$ID <- as.numeric(prothioconazole.SG$ID)
# Filter out
prothioconazole.SG <- prothioconazole.SG %>%
group_by(ID) %>%
mutate(Average = mean(EC50)) %>%
select(-EC50) %>%
rename(EC50_SG = Average) %>%
unique() %>%
ungroup()

##pyraclostrobin Plate dilution
pyraclostrobin.data <-
read.csv("data/pyraclostrobin.csv")

pyraclostrobin.data$repeats <-
rep_len(1:4, length.out = nrow(pyraclostrobin.data))
pyraclostrobin.data$ID <- as.character(pyraclostrobin.data$ID)
# renaming ID for the current names
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "541B"]  <- "541"

pyraclostrobin.data$ID[pyraclostrobin.data$ID == "293E"]  <- "293"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "973B"]  <- "973"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "973C"]  <- "973"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "973D"]  <- "973"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "974A"]  <- "974"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "974B"]  <- "974"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "974C"]  <- "974"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "974D"]  <- "974"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "975C"]  <- "975"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "975D"]  <- "975"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "975E"]  <- "975"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "976B"]  <- "976"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "976C"]  <- "976"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "977B"]  <- "977"
pyraclostrobin.data$ID[pyraclostrobin.data$ID == "978B"]  <- "978"
####Transforming to $ID to numeric
pyraclostrobin.data$ID <- as.numeric(pyraclostrobin.data$ID)
# Filter out
pyraclostrobin.data <- pyraclostrobin.data %>%
#filter(!dose ==  0.4 & !ID == 800) %>%
mutate(response = replace(response, response == 0, 0.6))  #replacing 0 cm growth for the size of plug that is 0.6


#Pyraclostrobin Serial dilution
pyraclostrobin.SG <-
read.csv("data/1_Day_SG/Pyraclostrobin.csv")

##Pyraclostrobin Spiral Gradient
pyraclostrobin.SG <- pyraclostrobin.SG %>%
rename(ID = Isolate)

pyraclostrobin.SG$ID <- as.character(pyraclostrobin.SG$ID)
# renaming ID for the current names
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "541B"]  <- "541"

pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "293E"]  <- "293"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "973B"]  <- "973"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "973C"]  <- "973"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "973D"]  <- "973"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "974A"]  <- "974"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "974B"]  <- "974"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "974C"]  <- "974"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "974D"]  <- "974"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "975C"]  <- "975"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "975D"]  <- "975"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "975E"]  <- "975"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "976B"]  <- "976"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "976C"]  <- "976"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "977B"]  <- "977"
pyraclostrobin.SG$ID[pyraclostrobin.SG$ID == "978B"]  <- "978"


####Transforming to $ID to numeric
pyraclostrobin.SG$ID <- as.numeric(pyraclostrobin.SG$ID)
# Filter out
pyraclostrobin.SG <- pyraclostrobin.SG %>%
group_by(ID) %>%
mutate(Average = mean(EC50)) %>%
select(-EC50) %>%
rename(EC50_SG = Average) %>%
unique() %>%
ungroup()

#thiophanate_methyl Plate dilution
  
thiophanate_methyl.data <-
  read.csv("data/thiophanate_methyl.csv")
  
  thiophanate_methyl.data$repeats <-
  rep_len(1:4, length.out = nrow(thiophanate_methyl.data))
  thiophanate_methyl.data$ID <-
  as.character(thiophanate_methyl.data$ID)
  # renaming ID for the current names
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "541B"]  <-
  "541"
  
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "293E"]  <-
  "293"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "973B"]  <-
  "973"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "973C"]  <-
  "973"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "973D"]  <-
  "973"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "974A"]  <-
  "974"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "974B"]  <-
  "974"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "974C"]  <-
  "974"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "974D"]  <-
  "974"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "975C"]  <-
  "975"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "975D"]  <-
  "975"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "975E"]  <-
  "975"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "976B"]  <-
  "976"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "976C"]  <-
  "976"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "977B"]  <-
  "977"
  thiophanate_methyl.data$ID[thiophanate_methyl.data$ID == "978B"]  <-
  "978"
  
  ####Transforming to $ID to numeric
  thiophanate_methyl.data$ID <- as.numeric(thiophanate_methyl.data$ID)
  # Filter out
  #thiophanate_methyl.data <- thiophanate_methyl.data %>%
  
  # mutate(response= replace(response, response == 0, 0.6))  #replacing 0 cm growth for the size of plug that is 0.6
  
  ##Thiophanate_methyl Spiral Gradient
  thiophanate_methyl.SG <-
  read.csv("data/1_Day_SG/Thiophanate_methyl.csv",  na.strings = TRUE)
  
  thiophanate_methyl.SG <- thiophanate_methyl.SG %>%
  rename(ID = Isolate)
  
  thiophanate_methyl.SG$ID <- as.character(thiophanate_methyl.SG$ID)
  # renaming ID for the current names
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "541B"]  <-
  "541"
  
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "293E"]  <-
  "293"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "973B"]  <-
  "973"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "973C"]  <-
  "973"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "973D"]  <-
  "973"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "974A"]  <-
  "974"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "974B"]  <-
  "974"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "974C"]  <-
  "974"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "974D"]  <-
  "974"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "975C"]  <-
  "975"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "975D"]  <-
  "975"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "975E"]  <-
  "975"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "976B"]  <-
  "976"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "976C"]  <-
  "976"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "977B"]  <-
  "977"
  thiophanate_methyl.SG$ID[thiophanate_methyl.SG$ID == "978B"]  <-
  "978"
  
  
  ####Transforming to $ID to numeric
  thiophanate_methyl.SG$ID <- as.numeric(thiophanate_methyl.SG$ID)
  # Filter out
  thiophanate_methyl.SG <- thiophanate_methyl.SG %>%
  group_by(ID) %>%
  mutate(Average = mean(EC50)) %>%
  select(-EC50) %>%
  rename(EC50_SG = Average) %>%
  unique() %>%
  ungroup()
  
```
## Function to detect ouliers among observations within same isolate and dose and take them away
```{r, echo=TRUE}
#Function to detect ouliers among observations within same isolate and dose and take them away

get_range <- function(mynumber) {
  bb <- boxplot.stats(mynumber)
  cc <- bb$stats
  dd <- max(cc)
  ee <- min(cc)
  return(data.frame(upper = dd, lower = ee))
}
```
# Determination of EC50 by Dose-response curve by  "ezec"package  using the “LL.3” model implemented in the R “drc” package 
```{r, echo= TRUE, include= FALSE}
#Boscalid
boscalid.filtered <- boscalid.data %>%
  group_by(ID, dose) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower) %>%
  ungroup() %>%
  select(c(ID, dose, response, repeats))
  
  aa <- EC_table(boscalid.filtered, form = response ~ dose)
  
  boscalid.PD <-
  aa %>% rename(ID = sample) %>% # renaming
  rename(EC50_PD = Estimate.50) %>%
  select(ID, EC50_PD)
  #Unfortunately Spiral gradient just release the EC50 average per isolate and no any model is provided
  boscalid.final <- boscalid.PD %>%
  left_join(boscalid.SG)
  
  #Fluazinam
  fluazinam.filtered <- fluazinam.data %>%
  group_by(ID, dose) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower) %>%
  ungroup() %>%
  select(c(ID, dose, response, repeats))
  
  bb <- EC_table(fluazinam.filtered, form = response ~ dose)
  
  fluazinam.PD <-
  bb %>% rename(ID = sample) %>% # renaming
  rename(EC50_PD = Estimate.50) %>%
  select(ID, EC50_PD)
  #Unfortunately Spiral gradient just release the EC50 average per isolate and no any model is provided
  fluazinam.final <- fluazinam.PD %>%
  left_join(fluazinam.SG)
  
  #Iprodione
  iprodione.filtered <- iprodione.data %>%
  group_by(ID, dose) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower) %>%
  ungroup() %>%
  select(c(ID, dose, response, repeats))
  
  cc <- EC_table(iprodione.filtered, form = response ~ dose)
  
  iprodione.PD <-
  cc %>% rename(ID = sample) %>% # renaming
  rename(EC50_PD = Estimate.50) %>%
  select(ID, EC50_PD)
  #Unfortunately Spiral gradient just release the EC50 average per isolate and no any model is provided
  iprodione.final <- iprodione.PD %>%
  left_join(iprodione.SG)
  #Procymidone
  procymidone.filtered <- procymidone.data %>%
  group_by(ID, dose) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower) %>%
  ungroup() %>%
  select(c(ID, dose, response, repeats))
  
  dd <- EC_table(procymidone.filtered, form = response ~ dose)
  
  procymidone.PD <-
  dd %>% rename(ID = sample) %>% # renaming
  rename(EC50_PD = Estimate.50) %>%
  select(ID, EC50_PD)
  #Unfortunately Spiral gradient just release the EC50 average per isolate and no any model is provided
  procymidone.final <- procymidone.PD %>%
  left_join(procymidone.SG)
  #Prothioonazole
  prothioconazole.filtered <- prothioconazole.data %>%
  group_by(ID, dose) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower) %>%
  ungroup() %>%
  select(c(ID, dose, response, repeats))
  
  ee <- EC_table(prothioconazole.filtered, form = response ~ dose)
  
  prothioconazole.PD <-
  ee %>% rename(ID = sample) %>% # renaming
  rename(EC50_PD = Estimate.50) %>%
  select(ID, EC50_PD)
  #Unfortunately Spiral gradient just release the EC50 average per isolate and no any model is provided
  prothioconazole.final <- prothioconazole.PD %>%
  left_join(prothioconazole.SG)
  
  #Pyraclostrobin
    pyraclostrobin.filtered <- pyraclostrobin.data %>%
  group_by(ID, dose) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower) %>%
  ungroup() %>%
  select(c(ID, dose, response, repeats))
  
  ff <- EC_table(pyraclostrobin.filtered, form = response ~ dose)
  
  pyraclostrobin.PD <-
  ff %>% rename(ID = sample) %>% # renaming
  rename(EC50_PD = Estimate.50) %>%
  select(ID, EC50_PD)
  #Unfortunately Spiral gradient just release the EC50 average per isolate and no any model is provided
  pyraclostrobin.final <- pyraclostrobin.PD %>%
  left_join(pyraclostrobin.SG)
  
  #Thiophanate methyl
  thiophanate_methyl.filtered <- thiophanate_methyl.data %>%
  group_by(ID, dose) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower) %>%
  ungroup() %>%
  select(c(ID, dose, response, repeats))
  
  gg <- EC_table(thiophanate_methyl.filtered, form = response ~ dose)
  
  thiophanate_methyl.PD <-
  gg %>% rename(ID = sample) %>% # renaming
  rename(EC50_PD = Estimate.50) %>%
  select(ID, EC50_PD)
  
  #Unfortunately Spiral gradient just release the EC50 average per isolate and no any model is provided
  thiophanate_methyl.final <- thiophanate_methyl.PD %>%
  left_join(thiophanate_methyl.SG)
  
```



# Probably solutions about the discussed problem  
It was suggested by Dr Drew Tyre, follow two possible choices:  
-Type II regression model  
-Fit a single dose response model to all the data,including the type of assay as a covariate on one or more of the parameters in the model. However, the spiral plater inject the fungicide in the petri plate as spiral way from the highest concentration (center) to the lowest (edges) and then we set should set the growth in comparison with a control,  in a special software (spiral plater software) and it delivers the EC50, so the measurements in cm (growth) are completely different from SG and AD. So then I am lack of more covariates unless the ID.

For that reason I will go for the Type II regression model which of the main difference with the type I is that X variable is the INDEPENDENT  and Y is the DEPENDENT variable. It assumes little or no error in X and all regression error is attributed to measurement or other error in Y. Meanwhile, Type II regression model which of neither X nor Y is an INDEPENDENT variable but both are assumed to be DEPENDENT on some other parameter which is often unknown. So, then both include some error.Anyways I will try first the linear model regression type I & GLM

# Type linear model regression & GLM
## Boscalid 


   
```{r BOSCALID  Linear model regression type I & GLM , echo=FALSE  , include=FALSE }

boscalid.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG) +ID, data =  boscalid.final)
summary(boscalid.model.1)


  tidy(boscalid.model.1, conf.int = TRUE)
  old.par = par(mfrow = c(2, 2))
  plot(boscalid.model.1)
  # the standarized residuals seem to be normal distributed, an assumption of the linear model. The variance seems somewhat homgoneous but not completely. There are 3 observations which have high impact in in the standirezd resdiduals & in leverage and in cook distance, respectively. It would be right to take them out.
  
  boscalid.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG) +ID , data =  boscalid.final[-c(19, 21, 22), ])
  boscalid.summary <- summary(boscalid.model.1)
  
  tidy(boscalid.model.1, conf.int = TRUE)
  old.par = par(mfrow = c(2, 2))
  plot(boscalid.model.1)
  
  # According to the R2, the proportion of the variation of  Y explained by  x is 0.24 or 24% which is low  
   
  #GLM
   boscalid.model.1.1 <-
  glm(log(EC50_PD) ~ log(EC50_SG) +ID , data =  boscalid.final[-c(19, 21, 22), ])
  summary(boscalid.model.1.1)
  #AIC is 30.128 
  boscalid.model.1.2 <-
  glm(log(EC50_PD) ~ log(EC50_SG), data =  boscalid.final[-c(19, 21, 22), ])
 boscalid.summary.2 <-  summary(boscalid.model.1.2)
  
  #AIC is 28.142
  #It is better without the parameter of ID
  
  
  
```
The standarized residuals seem to be normal distributed, an assumption of the linear model. The variance seems somewhat homgoneous but not completely. There are 3 observations which have high impact in in the standirezd resdiduals & in leverage and in cook distance, respectively. It would be right to take them out.

According to the R2, the proportion of the variation of  Y explained by  x is  **`r boscalid.summary[[8]][[1]]`**, that is low.  

In GLM, the best AIC is **`r boscalid.summary.2[[5]][[1]]`**, that is better without the parameter of ID

## Fluazinam
```{r FLUAZINAM  Linear model regression type I & GLM , echo=FALSE  , include=FALSE}
##Fluazinam
  fluazinam.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = fluazinam.final)
 fluazinam.summary <-  summary(fluazinam.model.1)
  
  tidy( fluazinam.model.1, conf.int = TRUE)
  old.par = par(mfrow = c(2, 2))
  plot(fluazinam.model.1)
  
  # the standarized residuals seem to be not normal distributed, a lack of assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is 05226 or 5.2% which is too low! 
  #GLM
  fluazinam.model.1.1 <-
  glm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = fluazinam.final)
  summary(fluazinam.model.1.1)
 
#  AIC is 6.707
   fluazinam.model.1.2 <-
  glm(log(EC50_PD) ~ log(EC50_SG), data = fluazinam.final)
  fluazinam.summary.2 <- summary(fluazinam.model.1.2)
  
  #  AIC is 5.5818
  #It is better without the parameter of ID
  
```
The standarized residuals seem to be not normal distributed, a lack of assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is  **`r fluazinam.summary[[8]][[1]]`** which is too low!
 

In GLM, the best AIC is **`r fluazinam.summary.2[[5]][[1]]`**, that  is better without the parameter of ID.

## Iprodione 

```{r IPRODIONE  Linear model regression type I & GLM , echo=FALSE  , include=FALSE}
##Iprodione
  iprodione.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = iprodione.final)
  iprodione.summary <- summary(iprodione.model.1)
  
  # the standarized residuals seem to be not normal distributed, a lack of assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is 0.2963 or 29.63% which is very low!
   tidy(iprodione.model.1, conf.int = TRUE)
  old.par = par(mfrow = c(2, 2))
  plot(iprodione.model.1)
  
  #GLM
  
  iprodione.model.1.1 <-
  glm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = iprodione.final)
  summary(iprodione.model.1.1)
  #AIC: -104.04
  iprodione.model.1.2 <-
  glm(log(EC50_PD) ~ log(EC50_SG), data = iprodione.final)
  iprodione.summary.2 <- summary(iprodione.model.1.2)
  #AIC: -94.488, it is better without the parameter of ID
  
  
```
The standarized residuals seem to be not normal distributed, a lack of assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is **`r iprodione.summary[[8]][[1]]`** which is low!
  

In GLM, the best AIC is **`r iprodione.summary.2[[5]][[1]]`**, that  is better without the parameter of ID.

## Procymidone 

```{r PROCYMIDONE  Linear model regression type I & GLM , echo=FALSE  , include=FALSE}
##Procymidone
  procymidone.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = procymidone.final)
  procymidone.summary <- summary(procymidone.model.1)
  # the standarized residuals seem to be not normal distributed, a lack of assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is 0.07238 or 7.2.% which is very low!
   tidy(procymidone.model.1, conf.int = TRUE)
  old.par = par(mfrow = c(2, 2))
  plot(procymidone.model.1)
  #GLM
  procymidone.model.1.1 <-
  glm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = procymidone.final)
  summary(procymidone.model.1.1)
  # AIC: -57.799
  procymidone.model.1.2 <-
  glm(log(EC50_PD) ~ log(EC50_SG), data = procymidone.final)
  procymidone.summary.2 <-  summary(procymidone.model.1.2)
  #AIC: -55.178, it is better without the parameter of ID
  
  
```
The standarized residuals seem to be not normal distributed, a lack of assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is **`r procymidone.summary[[8]][[1]]`** which is very low!

In GLM, the best AIC is **`r procymidone.summary.2[[5]][[1]]`**, that  is better without the parameter of ID.

## Prothioconazole
```{r PROTHIOCONAZOLE  Linear model regression type I & GLM , echo=FALSE  , include=FALSE}
##Prothioconazole
  prothioconazole.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG)+ID, data = prothioconazole.final)
 prothioconazole.summary <-  summary(prothioconazole.model.1)
  # the standarized residuals seem to be normal distributed, a lack of assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is 0.5537 or 55.37% which is low! There are 2 observations which have high impact in the residuals. It would be right to take them out.
  tidy(prothioconazole.model.1, conf.int = TRUE)
  old.par = par(mfrow = c(2, 2))
  plot(prothioconazole.model.1)
  
  
  prothioconazole.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = prothioconazole.final[-c(6, 10), ])
 prothioconazole.summary.2 <-  summary(prothioconazole.model.1)
  plot(prothioconazole.model.1)
  
 # Now   and according to the R2, the proportion of the variation of  Y explained by  x is 0.7129 or 71.29% whic is good in comparsions with the others
###GLM
  prothioconazole.model.1.1 <-
  glm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = prothioconazole.final[-c(6, 10), ])
 prothioconazole.summary.3 <-  summary(prothioconazole.model.1.1)
  # AIC: 17.571, it is better with the parameter of  ID
  
  prothioconazole.model.1.2 <-
  glm(log(EC50_PD) ~ log(EC50_SG), data = prothioconazole.final[-c(6, 10), ])
  summary(prothioconazole.model.1.2)
  #AIC: 28.624
  
```

The standarized residuals seem to be normal distributed, an assumption of the linear model. The variance seems somewhat homgoneous but not completely. According to the R2, the proportion of the variation of  Y explained by  x is **`r prothioconazole.summary[[8]][[1]]`**  which is low. There are 2 observations which have high impact in the residuals. It would be right to take them out.  

Now   and according to the R2, the proportion of the variation of  Y explained by  x is **`r prothioconazole.summary.2[[8]][[1]]`**  which is good in comparsions with the others.  

In GLM, the best AIC is **`r prothioconazole.summary.3[[5]][[1]]`**, that  is better with the parameter of ID.  

## Pyraclostrobin 

```{r PYRACLOSTROBIN  Linear model regression type I & GLM , echo=FALSE  , include=FALSE}
 ##Pyraclostrobin
  pyraclostrobin.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG) + ID, data = pyraclostrobin.final)
  summary(pyraclostrobin.model.1)
  
  tidy( pyraclostrobin.model.1, conf.int = TRUE)
  old.par = par(mfrow = c(2, 2))
  plot(pyraclostrobin.model.1)
  
  # the standarized residuals seem to be normal distributed, an assumption of the linear model. The variance seems somewhat homgoneous but not completely. There are 3 observations which have high impact in in the standirezd resdiduals & in leverage and in cook distance, respectively. It would be right to take them out.
  pyraclostrobin.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = pyraclostrobin.final[-c(15, 21, 23), ])
  pyraclostrobin.summary <- summary(pyraclostrobin.model.1)
  
  # Even though the R2, the proportion of the variation of  Y explained by  x is 0.1368 or 13.68% which is very low
  
  
  #GLM
  pyraclostrobin.model.1.1 <-
  glm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = pyraclostrobin.final[-c(15, 21, 23), ])
 pyraclostrobin.summary.2 <-  summary(pyraclostrobin.model.1.1)
  #AIC: -6.7674, it is better with the parameter of ID
  pyraclostrobin.model.1.2 <-
  glm(log(EC50_PD) ~ log(EC50_SG), data = pyraclostrobin.final[-c(15, 21, 23), ])
  summary(pyraclostrobin.model.1.2)
  #AIC: -8.3263
  
```
The standarized residuals seem to be normal distributed, an assumption of the linear model. The variance seems somewhat homogoneous but not completely. There are 3 observations which have high impact in in the standirezd resdiduals & in leverage and in cook distance, respectively. It would be right to take them out.    
Even though the R2, the proportion of the variation of  Y explained by  x is **`r pyraclostrobin.summary[[8]][[1]]`** which is very low.  
In GLM, the best AIC is **`r pyraclostrobin.summary.2[[5]][[1]]`**, that  is better with the parameter of ID.  

## Thiophanate methyl 

```{r THIOPHANATE METHYL  Linear model regression type I & GLM , echo=FALSE  , include=FALSE}
#Thiophanate_methyl
  thiophanate_methyl.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG)+ ID, data = thiophanate_methyl.final)
  summary(thiophanate_methyl.model.1)
  
  tidy(  thiophanate_methyl.model.1, conf.int = TRUE)
  
  old.par = par(mfrow = c(2, 2))
  plot(thiophanate_methyl.model.1)
  # the standarized residuals seem to be normal distributed, an assumption of the linear model. The variance seems somewhat homgoneous but not completely. There are 3 observations which have high impact in in the standirezd resdiduals. It would be right to take them out. Even though the R2, the proportion of the variation of  Y explained by  x is 0.03629 or 3.62 % which is very low
  
   thiophanate_methyl.model.1 <-
  lm(log(EC50_PD) ~ log(EC50_SG) +ID, data =  thiophanate_methyl.final[-c(5, 21, 25), ])
  thiophanate_methyl.summary <- summary(thiophanate_methyl.model.1)
   #GLM
   thiophanate_methyl.model.1.1 <-
  glm(log(EC50_PD) ~ log(EC50_SG) +ID, data =  thiophanate_methyl.final[-c(5, 21, 25), ])
  thiophanate_methyl.summary.2 <- summary(thiophanate_methyl.model.1.1)
   # AIC: -33.372, it is better with the parameter of ID
   thiophanate_methyl.model.1.2 <-
  glm(log(EC50_PD) ~ log(EC50_SG) , data =  thiophanate_methyl.final[-c(5, 21, 25), ])
   summary(thiophanate_methyl.model.1.2)
 #AIC: -35.365
  
```
The standarized residuals seem to be normal distributed, an assumption of the linear model. The variance seems somewhat homogoneous but not completely. There are 3 observations which have high impact in in the standirezd resdiduals. It would be right to take them out. Even though the R2, the proportion of the variation of  Y explained by  x is **`r thiophanate_methyl.summary[[8]][[1]]`** which is very low.

In GLM, the best AIC is **`r thiophanate_methyl.summary.2[[5]][[1]]`**, that  is better with the parameter of ID
  
# Type II linear model regression   

## Boscalid
```{r BOSCALID Linear model regression type II, echo=FALSE, include= FALSE}

boscalid.model.2 <-
  lmodel2(log(EC50_PD) ~ log(EC50_SG)+ ID,
  data = boscalid.final, range.y = "interval", range.x = "interval",nperm = 99)
  summary(boscalid.model.2)
plot(boscalid.model.2)
plot(boscalid.model.2,"RMA")
plot(boscalid.model.2,"OLS")
plot(boscalid.model.2,"SMA")


```

```{r}
plot(boscalid.model.2)
```


## Fluazinam
```{r FLUAZINAM Linear model regression type II, echo=FALSE, include= FALSE}

fluazinam.model.2 <-
  lmodel2(log(EC50_PD) ~ log(EC50_SG) +ID,
  data = fluazinam.final, range.y = "interval", range.x = "interval",nperm = 99)
  summary(fluazinam.model.2)
plot(fluazinam.model.2)
plot(fluazinam.model.2,"RMA")
plot(fluazinam.model.2,"OLS")
plot(fluazinam.model.2,"SMA")

```

```{r}
plot(fluazinam.model.2,"SMA")
```

## Iprodione
```{r IPRODIONE Linear model regression type II, echo=FALSE, include= FALSE}

iprodione.model.2 <-
  lmodel2(log(EC50_PD) ~ log(EC50_SG) + ID,
  data = iprodione.final, range.y = "interval", range.x = "interval",nperm = 99)
  summary(iprodione.model.2)
plot(iprodione.model.2)
plot(iprodione.model.2,"RMA")
plot(iprodione.model.2,"OLS")
plot(iprodione.model.2,"SMA")

```

```{r}
plot(iprodione.model.2,"SMA")
```

## Procymidone
```{r PROCYMIDONE Linear model regression type II, echo=FALSE, include= FALSE}

procymidone.model.2 <-
  lmodel2(log(EC50_PD) ~ log(EC50_SG)+ ID,
  data = procymidone.final, range.y = "interval", range.x = "interval",nperm = 99)
  summary(procymidone.model.2)
plot(procymidone.model.2)
plot(procymidone.model.2,"RMA")
plot(procymidone.model.2,"OLS")
plot(procymidone.model.2,"SMA")
```

```{r}
plot(procymidone.model.2,"SMA")
```

## Prothioconazole
```{r PROTHIOCONAZOLE Linear model regression type II, echo=FALSE, include= FALSE}

prothioconazole.model.2 <-
  lmodel2(log(EC50_PD) ~ log(EC50_SG)+ ID,
  data = prothioconazole.final, range.y = "interval", range.x = "interval",nperm = 99)
  summary(prothioconazole.model.2)
plot(prothioconazole.model.2)
plot(prothioconazole.model.2,"RMA")
plot(prothioconazole.model.2,"OLS")
plot(prothioconazole.model.2,"SMA")


```

```{r}
plot(prothioconazole.model.2,"RMA")
```

## Pyraclostrobin
```{r PYRACLOSTROBIN Linear model regression type II, echo=FALSE, include= FALSE}
pyraclostrobin.model.2 <-
  lmodel2(log(EC50_PD) ~ log(EC50_SG)+ ID,
  data = pyraclostrobin.final, range.y = "interval", range.x = "interval",nperm = 99)
  summary(pyraclostrobin.model.2)
plot(pyraclostrobin.model.2)
plot(pyraclostrobin.model.2,"RMA")
plot(pyraclostrobin.model.2,"OLS")
plot(pyraclostrobin.model.2,"SMA")



```

```{r}
plot(pyraclostrobin.model.2,"SMA")
```

## Thiophanate_methyl
```{r Thiophanate_methyl Linear model regression type II,echo=FALSE, include= FALSE}

thiophanate_methyl.model.2 <-
  lmodel2(log(EC50_PD) ~ log(EC50_SG)+ ID,
  data = thiophanate_methyl.final, range.y = "interval", range.x = "interval",nperm = 99)
  summary(thiophanate_methyl.model.2)
plot(thiophanate_methyl.model.2)
plot(thiophanate_methyl.model.2,"RMA")
plot(thiophanate_methyl.model.2,"OLS")
plot(thiophanate_methyl.model.2,"SMA")


```

```{r}
plot(thiophanate_methyl.model.2,"RMA")
```


# Plug and Paper inoculum comparison on PDA by a given discriminatory concentration of the fungicides

```{r Plug and Paper  comparison on PDA, echo=TRUE, include=FALSE}
####
plug.discs <-
  read.csv(
  "data/Paper_discs_vs_PLUG.csv",
  stringsAsFactors = TRUE,
  na.strings = TRUE
  )
  plug.discs$Fungicide <- str_squish(plug.discs$Fungicide)
  stopifnot(nrow(plug.discs) == 7 * 11 * 2 * 2 * 2 * 4)
  #Y <- read.csv("data/Paper_discs_vs_PLUG.csv", stringsAsFactors = TRUE, na.strings = TRUE)
  
  #stopifnot(nrow(plugdiscs)== 7*11*2*2*2*4)
  plug.discs <- plug.discs %>%
  mutate(inoculum = as.character(inoculum)) %>%
  rename(ID = inoculum,
  experimental_replicate = experimental_repetition) %>%
      mutate(growth= growth - 0.6) %>%  #subtracting the growth of the size of plug that is 0.6 cm
    
  select(Fungicide,
  ID,
  experiment,
  experimental_replicate,
  treatment,
  growth) %>%
  group_by(Fungicide, ID, experiment, experimental_replicate, treatment) %>% mutate(rep = 1:4) %>% spread(treatment, growth) %>%
  ungroup()
  # group_by(ID, experiment, experimental_repeatlicate)
  #spread( treatment )
```


## Boscalid
```{r Boscalid non parametric test, echo=FALSE, include=FALSE}

#boscalid
boscalid.plug.discs <-
plug.discs %>% filter(Fungicide == "boscalid") %>%
rename(response = fungicide) %>%
select(-Fungicide)

boscalid.plug.discs.filtered <-
boscalid.plug.discs %>%
group_by(ID, experiment) %>%
mutate(response_range = list(get_range(response))) %>%
unnest() %>%
mutate(control_range = list(get_range(control))) %>%
unnest() %>%
filter(response <= upper &
response >= lower,
control <= upper1 & control >= lower1) %>%
ungroup() %>%
select(c(ID, experiment,  experimental_replicate, rep, response, control)) %>% 
# Percent inhibition is (control - funcide) / (control)
mutate(inhibition = 100 * ((control - response) / control)) %>%
#taking again outliers based on inhibition
group_by(ID, experiment) %>%
mutate(inhibition_range = list(get_range(inhibition))) %>%
unnest() %>%
filter(inhibition <= upper &
inhibition >= lower) %>%
ungroup()

## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
boscalid.plug.discs.filtered %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$inhibition)))

# transforming to log
boscalid.plug.discs.filtered.2 <-
boscalid.plug.discs.filtered %>%
mutate(log.inhibition = log(inhibition))
###
## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
boscalid.plug.discs.filtered.2 %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$log.inhibition)))



#non parametric between experimental repeatlicates and experiment, there is differenc between experiment and experimental replicates, so I cant join data from experimental replicates
boscalid.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experimental_replicate,
data = .)


boscalid.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experiment,
data = .)

# Now Dunn test

boscalid.plug.discs.filtered  %>% DunnTest(inhibition ~ experiment, data = ., method = "bonferroni")
#P VALUE 0.000016 *** plug-paper

```

```{r Boscalid linear model, echo=TRUE, include=TRUE}


 boscalid.plug.discs.filtered.2 <- boscalid.plug.discs.filtered %>% select(-c(response, control, upper, lower)) %>% group_by(ID, experiment, rep )%>% spread(experiment , inhibition) %>%ungroup() 
  
  # now linear model
 
  boscalid.plug.discs.filtered.model <-  lm(plug~paper+ ID + experimental_replicate+ rep,data = boscalid.plug.discs.filtered.2)
boscalid.plug.discs.filtered.model.summary <-   summary( boscalid.plug.discs.filtered.model)


test.boscalid.plug.discs.filtered.model <- augment(boscalid.plug.discs.filtered.model, data=boscalid.plug.discs.filtered.2)
ggplot(
  test.boscalid.plug.discs.filtered.model,
  aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_smooth(color = "red")
  
```
the R2, the proportion of the variation of  Y explained by  x is **`r boscalid.plug.discs.filtered.model.summary[[9]][[1]]`** which is very good.


## Fluazinam
```{r Fluazinam non parametric test, echo=FALSE, include=FALSE}
#Fluazinam
fluazinam.plug.discs <-
plug.discs %>% filter(Fungicide == "fluazinam") %>%
rename(response = fungicide) %>%
select(-Fungicide)

fluazinam.plug.discs.filtered <-  fluazinam.plug.discs %>%
group_by(ID, experiment) %>%
mutate(response_range = list(get_range(response))) %>%
unnest() %>%
mutate(control_range = list(get_range(control))) %>%
unnest() %>%
filter(response <= upper &
response >= lower,
control <= upper1 & control >= lower1) %>%
ungroup() %>%
select(c(ID, experiment,  experimental_replicate, rep, response, control)) %>%

# Percent inhibition is (control - funcide) / (control)
mutate(inhibition = 100 * ((control - response) / control)) %>%
#taking again outliers based on inhibition
group_by(ID, experiment) %>%
mutate(inhibition_range = list(get_range(inhibition))) %>%
unnest() %>%
filter(inhibition <= upper &
inhibition >= lower) %>%
ungroup()
## shapiro test for normality between groups of experimental replicates. There is normality between experimental replicates
fluazinam.plug.discs.filtered %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$inhibition)))

#ANOVA between experimental repeatlicates and experiment, there is difference between experiment and experimental replicates, so I cant join data from experimental replicates

fluazinam.plug.discs.filtered  %>%
aov(inhibition ~ experiment  + experimental_replicate,
data = .) %>%
summary()

```

```{r Fluazinam linear model, echo=TRUE, include=TRUE}
fluazinam.plug.discs.filtered.2 <- fluazinam.plug.discs.filtered %>% select(-c(response, control, upper, lower)) %>% group_by(ID, experiment, rep )%>% spread(experiment , inhibition) %>%ungroup() 
  
  # now linear model
 
  fluazinam.plug.discs.filtered.model <-  lm(plug~paper+ ID + experimental_replicate+ rep,data = fluazinam.plug.discs.filtered.2)
  fluazinam.plug.discs.filtered.model.summary <-summary( fluazinam.plug.discs.filtered.model)



test.fluazinam.plug.discs.filtered.model <- augment(fluazinam.plug.discs.filtered.model, data=fluazinam.plug.discs.filtered.2)
ggplot(
  test.fluazinam.plug.discs.filtered.model,
  aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_smooth(color = "red")
  #GLM
 glm(plug~paper+ ID + experimental_replicate+ rep,data = fluazinam.plug.discs.filtered.2)
 glm(plug~paper+ ID + experimental_replicate,data = fluazinam.plug.discs.filtered.2)
glm(plug~paper+ ID ,data = fluazinam.plug.discs.filtered.2)
glm(plug~paper,data = fluazinam.plug.discs.filtered.2)
fluazinam.plug.discs.filtered.model.summary.2 <- glm(plug~paper+ ID + experimental_replicate+ rep,data = fluazinam.plug.discs.filtered.2)

```
the R2, the proportion of the variation of  Y explained by  x is **`r fluazinam.plug.discs.filtered.model.summary[[9]][[1]]`** that still being low although improved in comparison with Spiral gradient. 
The best glm was when all parameters and the AIC was the lowest with **`r fluazinam.plug.discs.filtered.model.summary.2[[11]][[1]]`**

## Iprodione
```{r Iprodione non parametric test, echo=FALSE, include=FALSE}


iprodione.plug.discs <-
plug.discs %>% filter(Fungicide == "iprodione") %>%
rename(response = fungicide) %>%
select(-Fungicide)

iprodione.plug.discs.filtered <-  iprodione.plug.discs %>%
group_by(ID, experiment) %>%
mutate(response_range = list(get_range(response))) %>%
unnest() %>%
mutate(control_range = list(get_range(control))) %>%
unnest() %>%
filter(response <= upper &
response >= lower,
control <= upper1 & control >= lower1) %>%
ungroup() %>%
select(c(ID, experiment,  experimental_replicate, rep, response, control)) %>%

# Percent inhibition is (control - funcide) / (control)
mutate(inhibition = 100 * ((control - response) / control)) %>%
#taking again outliers based on inhibition
group_by(ID, experiment) %>%
mutate(inhibition_range = list(get_range(inhibition))) %>%
unnest() %>%
filter(inhibition <= upper &
inhibition >= lower) %>%
ungroup()
## shapiro test for normality between groups of experimental replicates. There is normality in one exp replicate but not in the other one
iprodione.plug.discs.filtered %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$inhibition)))


# transforming to log
iprodione.plug.discs.filtered.2 <-
iprodione.plug.discs.filtered %>%
mutate(log.inhibition = log(inhibition))
###
## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
iprodione.plug.discs.filtered.2 %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$log.inhibition)))


#non parametric test between experimental repeatlicates and experiment, there is differenc between experiment and experimental replicates, so I cant join data from experimental replicates

iprodione.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experimental_replicate,
data = .)


iprodione.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experiment,
data = .)

# Now Dunn test

iprodione.plug.discs.filtered  %>% DunnTest(inhibition ~ experiment, data = ., method = "bonferroni")
#P VALUE 0.0258 *plug-paper


```

```{r Iprodione linear model, echo=TRUE, include=TRUE}

iprodione.plug.discs.filtered.2 <- iprodione.plug.discs.filtered %>% select(-c(response, control, upper, lower)) %>% group_by(ID, experiment, rep )%>% spread(experiment , inhibition) %>%ungroup() 
  
  # now linear model
 
  iprodione.plug.discs.filtered.model <-  lm(plug~paper+ ID + experimental_replicate+ rep,data = iprodione.plug.discs.filtered.2)
  iprodione.plug.discs.filtered.model.summary <-summary( iprodione.plug.discs.filtered.model)
#GLM
  glm(plug~paper+ ID + experimental_replicate+ rep,data = iprodione.plug.discs.filtered.2)
glm(plug~paper+ ID + experimental_replicate,data = iprodione.plug.discs.filtered.2)
glm(plug~paper+ ID ,data = iprodione.plug.discs.filtered.2)
glm(plug~paper,data = iprodione.plug.discs.filtered.2)

iprodione.plug.discs.filtered.model.summary.2 <- summary(glm(plug~paper+ ID + experimental_replicate+ rep,data = iprodione.plug.discs.filtered.2))
test.iprodione.plug.discs.filtered.model <- augment(iprodione.plug.discs.filtered.model, data=iprodione.plug.discs.filtered.2)
ggplot(
  test.iprodione.plug.discs.filtered.model,
  aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_smooth(color = "red")
  

```
the R2, the proportion of the variation of  Y explained by  x is **`r iprodione.plug.discs.filtered.model.summary[[9]][[1]]`** still being low although improved in comparison with Spiral gradient.  
The best glm was when all parameters and the AIC was the lowest with **`r iprodione.plug.discs.filtered.model.summary.2[[11]][[1]]`**

## Procymidone
```{r Procymidone non parametric test, echo=FALSE, include=FALSE}


procymidone.plug.discs <-
plug.discs %>% filter(Fungicide == "procymidone") %>%
rename(response = fungicide) %>%
select(-Fungicide)

procymidone.plug.discs.filtered <-  procymidone.plug.discs %>%
group_by(ID, experiment) %>%
mutate(response_range = list(get_range(response))) %>%
unnest() %>%
mutate(control_range = list(get_range(control))) %>%
unnest() %>%
filter(response <= upper &
response >= lower,
control <= upper1 & control >= lower1) %>%
ungroup() %>%
select(c(ID, experiment,  experimental_replicate, rep, response, control)) %>%

# Percent inhibition is (control - funcide) / (control)
mutate(inhibition = 100 * ((control - response) / control)) %>%
#taking again outliers based on inhibition
group_by(ID, experiment) %>%
mutate(inhibition_range = list(get_range(inhibition))) %>%
unnest() %>%
filter(inhibition <= upper &
inhibition >= lower) %>%
ungroup()
## shapiro test for normality between groups of experimental replicates. There is normality in one experimental replicate but not in the other one
procymidone.plug.discs.filtered %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$inhibition)))

# transforming to square
procymidone.plug.discs.filtered.2 <-
procymidone.plug.discs.filtered %>%
mutate(square.inhibition = inhibition ^ 2)
###
## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
procymidone.plug.discs.filtered.2 %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$square.inhibition)))


# non parametric test between experimental repeatlicates and experiment, there is differenc between  experimental replicates (so I cant join data from experimental) but not  between experiments

procymidone.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experimental_replicate,
data = .)


procymidone.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experiment,
data = .)
#p value = 0.09274

```

```{r Procymidone linear model, echo=TRUE, include=TRUE}
procymidone.plug.discs.filtered.2 <- procymidone.plug.discs.filtered %>% select(-c(response, control, upper, lower)) %>% group_by(ID, experiment, rep )%>% spread(experiment , inhibition) %>%ungroup() 
  
  # now linear model
 
  procymidone.plug.discs.filtered.model <-  lm(plug~paper+ ID + experimental_replicate+ rep,data = procymidone.plug.discs.filtered.2)
 procymidone.plug.discs.filtered.model.summary <- summary( procymidone.plug.discs.filtered.model)

#GLM
  glm(plug~paper+ ID + experimental_replicate+ rep,data = procymidone.plug.discs.filtered.2)
  glm(plug~paper+ ID + experimental_replicate,data = procymidone.plug.discs.filtered.2)
 procymidone.plug.discs.filtered.model.summary.2 <-   summary(glm(plug~paper+ ID ,data = procymidone.plug.discs.filtered.2))

   glm(plug~paper,data = procymidone.plug.discs.filtered.2)

   test.procymidone.plug.discs.filtered.model <- augment(procymidone.plug.discs.filtered.model, data=procymidone.plug.discs.filtered.2)
ggplot(
  test.procymidone.plug.discs.filtered.model,
  aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_smooth(color = "red")
  

```
the R2, the proportion of the variation of  Y explained by  x is **`r procymidone.plug.discs.filtered.model.summary[[9]][[1]]`** still being very low.

The best glm was when just paper & plug parameters and the AIC was the lowest with **`r procymidone.plug.discs.filtered.model.summary.2[[11]][[1]]`**

## Prothioconazole
```{r Prothioconazole non parametric test, echo=FALSE, include=FALSE}
## Prothioconazole
prothioconazole.plug.discs <-
plug.discs %>% filter(Fungicide == "prothioconazole") %>%
rename(response = fungicide) %>%
select(-Fungicide)

prothioconazole.plug.discs.filtered <-
prothioconazole.plug.discs %>%
group_by(ID, experiment) %>%
mutate(response_range = list(get_range(response))) %>%
unnest() %>%
mutate(control_range = list(get_range(control))) %>%
unnest() %>%
filter(response <= upper &
response >= lower,
control <= upper1 & control >= lower1) %>%
ungroup() %>%
select(c(ID, experiment,  experimental_replicate, rep, response, control)) %>%

# Percent inhibition is (control - funcide) / (control)
mutate(inhibition = 100 * ((control - response) / control)) %>%
#taking again outliers based on inhibition
group_by(ID, experiment) %>%
mutate(inhibition_range = list(get_range(inhibition))) %>%
unnest() %>%
filter(inhibition <= upper &
inhibition >= lower) %>%
ungroup()
## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
prothioconazole.plug.discs.filtered %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$inhibition)))

# transforming to log
prothioconazole.plug.discs.filtered.2 <-
prothioconazole.plug.discs.filtered %>%
mutate(log.inhibition = log(inhibition))
###
## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
prothioconazole.plug.discs.filtered.2 %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$log.inhibition)))


# non parametric test between experimental repeatlicates and experiment, there is no difference between experiment and  experimental replicates, so I can join data from experimental replicates

prothioconazole.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experimental_replicate,
data = .)


prothioconazole.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experiment,
data = .)


```

```{r Prothioconazole linear model, echo=TRUE, include=TRUE}
prothioconazole.plug.discs.filtered.2 <- prothioconazole.plug.discs.filtered %>% select(-c(response, control, upper, lower)) %>% group_by(ID, experiment, rep )%>% spread(experiment , inhibition) %>%ungroup() 
  
  # now linear model
 
  prothioconazole.plug.discs.filtered.model <-  lm(plug~paper+ ID + experimental_replicate+ rep,data = prothioconazole.plug.discs.filtered.2)
 prothioconazole.plug.discs.filtered.model.summary <- summary( prothioconazole.plug.discs.filtered.model)


test.prothioconazole.plug.discs.filtered.model <- augment(prothioconazole.plug.discs.filtered.model, data=prothioconazole.plug.discs.filtered.2)
ggplot(
  test.prothioconazole.plug.discs.filtered.model,
  aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_smooth(color = "red")
  

```
the R2, the proportion of the variation of  Y explained by  x is **`r prothioconazole.plug.discs.filtered.model.summary[[9]][[1]]`** which is very good, in fact, the best.  


## Pyraclostrobin
```{r Pyraclostrobin non parametric test, echo=FALSE, include=FALSE}
## Pyraclostrobin
pyraclostrobin.plug.discs <-
plug.discs %>% filter(Fungicide == "pyraclostrobin") %>%
rename(response = fungicide) %>%
select(-Fungicide)

pyraclostrobin.plug.discs.filtered <-  pyraclostrobin.plug.discs %>%
group_by(ID, experiment) %>%
mutate(response_range = list(get_range(response))) %>%
unnest() %>%
mutate(control_range = list(get_range(control))) %>%
unnest() %>%
filter(response <= upper &
response >= lower,
control <= upper1 & control >= lower1) %>%
ungroup() %>%
select(c(ID, experiment,  experimental_replicate, rep, response, control)) %>%

# Percent inhibition is (control - funcide) / (control)
mutate(inhibition = 100 * ((control - response) / control)) %>%
#taking again outliers based on inhibition
group_by(ID, experiment) %>%
mutate(inhibition_range = list(get_range(inhibition))) %>%
unnest() %>%
filter(inhibition <= upper &
inhibition >= lower) %>%
ungroup()
## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
pyraclostrobin.plug.discs.filtered %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$inhibition)))

# transforming to log
pyraclostrobin.plug.discs.filtered.2 <-
pyraclostrobin.plug.discs.filtered %>%
mutate(log.inhibition = log(inhibition))
###
## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
pyraclostrobin.plug.discs.filtered.2 %>%
group_by(experimental_replicate) %>%
do(tidy(shapiro.test(.$log.inhibition)))


# no parametric test between experimental repeatlicates and experiment, there is differenc between experiment and experimental replicates, so I cant join data from experimental replicates

pyraclostrobin.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experimental_replicate,
data = .)


pyraclostrobin.plug.discs.filtered  %>%
kruskal.test(inhibition ~ experiment,
data = .)

# Now Dunn test

pyraclostrobin.plug.discs.filtered  %>% DunnTest(inhibition ~ experiment, data = ., method = "bonferroni")
#P VALUE 0.000000000000079 *** plug-paper



```

```{r Pyraclostrobin linear model, echo=TRUE, include=TRUE}
pyraclostrobin.plug.discs.filtered.2 <- pyraclostrobin.plug.discs.filtered %>% select(-c(response, control, upper, lower)) %>% group_by(ID, experiment, rep )%>% spread(experiment , inhibition) %>%ungroup() 
  
  # now linear model
 
  pyraclostrobin.plug.discs.filtered.model <-  lm(plug~paper+ ID + experimental_replicate+ rep,data = pyraclostrobin.plug.discs.filtered.2)
  pyraclostrobin.plug.discs.filtered.model.summary <-summary( pyraclostrobin.plug.discs.filtered.model)


#GLM
  glm(plug~paper+ ID + experimental_replicate+ rep,data = pyraclostrobin.plug.discs.filtered.2)

  pyraclostrobin.plug.discs.filtered.model.summary.2 <- summary( glm(plug~paper+ ID + experimental_replicate,data = pyraclostrobin.plug.discs.filtered.2))
  
   glm(plug~paper+ ID ,data = pyraclostrobin.plug.discs.filtered.2)
   
   glm(plug~paper ,data = pyraclostrobin.plug.discs.filtered.2)
   
  test.pyraclostrobin.plug.discs.filtered.model <- augment(pyraclostrobin.plug.discs.filtered.model, data=pyraclostrobin.plug.discs.filtered.2)
ggplot(
  test.pyraclostrobin.plug.discs.filtered.model,
  aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_smooth(color = "red")
  

```
the R2, the proportion of the variation of  Y explained by  x is **`r pyraclostrobin.plug.discs.filtered.model.summary[[9]][[1]]`** which is fair in comparison with the one obtained from Spiral gradient.  

The best glm was when just paper & plug parameters and the AIC was the lowest with **`r pyraclostrobin.plug.discs.filtered.model.summary.2[[5]][[1]]`**

## Thiophanate_methyl
```{r Thiophanate_methyl non parametric test, echo=FALSE, include=FALSE}

TM.plug.discs <-
  plug.discs %>% filter(Fungicide == "thiophanate_methyl") %>%
  rename(response = fungicide) %>%
  select(-Fungicide)
  
  TM.plug.discs.filtered <-  TM.plug.discs %>%
  group_by(ID, experiment) %>%
  mutate(response_range = list(get_range(response))) %>%
  unnest() %>%
  mutate(control_range = list(get_range(control))) %>%
  unnest() %>%
  filter(response <= upper &
  response >= lower,
  control <= upper1 & control >= lower1) %>%
  ungroup() %>%
  select(c(ID, experiment,  experimental_replicate, rep, response, control)) %>%
  
  # Percent inhibition is (control - funcide) / (control)
  mutate(inhibition = 100 * ((control - response) / control)) %>%
  #taking again outliers based on inhibition
  group_by(ID, experiment) %>%
  mutate(inhibition_range = list(get_range(inhibition))) %>%
  unnest() %>%
  filter(inhibition <= upper &
  inhibition >= lower) %>%
  ungroup()
  ## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
  TM.plug.discs.filtered %>%
  group_by(experimental_replicate) %>%
  do(tidy(shapiro.test(.$inhibition)))
  
  # transforming to square
  TM.plug.discs.filtered.2 <-  TM.plug.discs.filtered %>%
  mutate(square.inhibition = inhibition ^ 2)
  ###
  ## shapiro test for normality between groups of experimental replicates. There are no normality between experimental replicates
  TM.plug.discs.filtered.2 %>%
  group_by(experimental_replicate) %>%
  do(tidy(shapiro.test(.$square.inhibition)))
  
  
  # non parametric test between experimental repeatlicates and experiment, there is differenc between experiment and no between experimental replicates, so I can join data from experimental replicates
  
  TM.plug.discs.filtered  %>%
  kruskal.test(inhibition ~ experimental_replicate,
  data = .)
  
  
  TM.plug.discs.filtered  %>%
  kruskal.test(inhibition ~ experiment,
  data = .)
  
  # Now Dunn test
  
  TM.plug.discs.filtered  %>% DunnTest(inhibition ~ experiment, data = ., method = "bonferroni")
  #P VALUE 0.0456 * plug-paper
  
  
```

```{r Thiophanate methyl linear model, echo=TRUE, include=TRUE}
 TM.plug.discs.filtered.2 <- TM.plug.discs.filtered %>% select(-c(response, control, upper, lower)) %>% group_by(ID, experiment, rep )%>% spread(experiment , inhibition) %>%ungroup() 
  
  # now linear model
 
  TM.plug.discs.filtered.model <-  lm(plug~paper+ ID + experimental_replicate+ rep,data = TM.plug.discs.filtered.2)
  TM.plug.discs.filtered.model.summary <-summary( TM.plug.discs.filtered.model)
 
  #GLM
  glm(plug~paper+ ID + experimental_replicate+ rep,data = TM.plug.discs.filtered.2)
  glm(plug~paper+ ID + experimental_replicate,data = TM.plug.discs.filtered.2)
  TM.plug.discs.filtered.model.summary.2 <- summary(glm(plug~paper+ ID ,data = TM.plug.discs.filtered.2))
glm(plug~paper,data = TM.plug.discs.filtered.2)

test.TM.plug.discs.filtered.model <- augment(TM.plug.discs.filtered.model, data=TM.plug.discs.filtered.2)
ggplot(
  test.TM.plug.discs.filtered.model,
  aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_smooth(color = "red")
  

```
the R2, the proportion of the variation of  Y explained by  x is **`r TM.plug.discs.filtered.model.summary[[9]][[1]]`** which is low-fair.

The best glm was when just paper,  plug, & ID parameters and the AIC was the lowest with **`r TM.plug.discs.filtered.model.summary.2[[5]][[1]]`**

# Discussions
By type I linear model in EC50 comparisons with just one covariate, sometimes the fungicides had better AIC in GLM (by the link = "identity") when the parameter/covariate added but other times when not added. However, when comparison of paper and plug inoculum by given discriminatory doses, R2 from the type I linear model, increased many as compared with the previous. Further, according to the GLM (by the link = "identity") the best AIC was obtained when all parameters or mostly all parameters set in the model, as the case of boscalid, however for fluazinam,  and iprodione, the effort was not enough. Perhaps, the R2 can be improved if remove observations that affect the assumptions of the linear regressions. 

By type II linear model in EC50 comparisons with just one parameter/covariate, it was possible to carry out by 99 permutations and a range of interval for x & y.

Prothioconazole was the best fit fungicide; nevertheless,  the significant improvement occurred when using many parameters in the model at the last test. However, the R2 of pyraclostrobin and thiophanate methyl did not have enough effort, in which the GLM (by the link = "identity") showed the best parameters to be only to the paper and plug (opposite to the other fungicides). That indicates that the size of the error of SG is considerable, and it was not possible to relate with some potential parameter/covariate to know which ones affect them more. 

Procymidone fungicide had very low R2  in both tests,  the comparison of EC50 values and with paper and plug comparisons, so, that indicates the error using this fungicide is even bigger than with the rest of fungicides used in this study.

